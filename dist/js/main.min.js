"use strict";function _createForOfIteratorHelper(e,t){var s,n,b,o,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return n=!(s=!0),{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){n=!0,b=e},f:function(){try{s||null==r.return||r.return()}finally{if(n)throw b}}};if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var s;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(s="Object"===(s=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:s)||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var gamePlate=document.querySelector(".game-box__plate"),navBar=document.querySelector(".navbar"),gameList=document.querySelector(".navbar__list-game"),navItems=gameList.querySelectorAll(".navbar__list__item"),counterMines=document.querySelector(".counter-mines"),begginer=[8,8,10],intermediate=[16,16,40],expert=[31,16,99],bombs=[],boxes=[],chosenLevel=begginer,countBoxes=function(e){return e[0]*e[1]},shuffle=function(e,t){for(var s=0;s<t;s++){var n=Math.floor(Math.random()*e);0===n||bombs.includes(n)?s--:bombs.push(n)}},GamePlate=_createClass(function e(t,s){_classCallCheck(this,e),this.id=t,this.bomb=s}),createGamePlate=function(e){for(var t=0;t<e;t++)boxes[t]=new GamePlate(t,!1)},plantBombs=function(){boxes.forEach(function(e){bombs.includes(e.id)&&(e.bomb=!0)})},drawGamePlate=function(e){for(var t=0;t<e;t++){var s=document.createElement("div");s.setAttribute("id",t),gamePlate.append(s),s.classList.add("game-box__plate__element")}counterMines.innerHTML="0".concat(chosenLevel[2])},clearPlate=function(){gamePlate.innerHTML="",bombs=[],boxes=[]},newGame=function(){clearPlate(),counterMines.innerHTML="0".concat(chosenLevel[2]),shuffle(countBoxes(chosenLevel),chosenLevel[2]),createGamePlate(countBoxes(chosenLevel)),plantBombs(),drawGamePlate(countBoxes(chosenLevel))},chooseLevel=function(e){clearPlate(),e.target.classList.contains("begginer")?(chosenLevel=begginer,gamePlate.classList.remove("plate-intermediate"),gamePlate.classList.remove("plate-expert"),gamePlate.classList.add("plate-begginer")):e.target.classList.contains("intermediate")?(chosenLevel=intermediate,gamePlate.classList.remove("plate-begginer"),gamePlate.classList.remove("plate-expert"),gamePlate.classList.add("plate-intermediate")):e.target.classList.contains("expert")&&(chosenLevel=expert,gamePlate.classList.remove("plate-begginer"),gamePlate.classList.remove("plate-intermediate"),gamePlate.classList.add("plate-expert")),navItems.forEach(function(e){return e.classList.toggle("navbar__list-game__item")}),newGame()},unfoldMenu=function(e){e.target.classList.contains("navbar__list-game")&&navItems.forEach(function(e){return e.classList.toggle("navbar__list-game__item")})},putFlag=function(e){e.preventDefault(),e.target.classList.toggle("put-flag")},showAll=function(){var e,t=gamePlate.getElementsByClassName("game-box__plate__element"),s=_createForOfIteratorHelper(boxes);try{for(s.s();!(e=s.n()).done;){var n=e.value;!0!==n.bomb||t[n.id].classList.contains("put-flag")||t[n.id].classList.add("show-bomb"),!1===n.bomb&&t[n.id].classList.contains("put-flag")&&t[n.id].classList.add("wrong-bet")}}catch(e){s.e(e)}finally{s.f()}},bombsNumber=0,checkBombAround=function(e,t){var s=Number.parseFloat(e.target.id);0===s?(bombs.includes(s+1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+(t+1))&&bombsNumber++):s===t-1?(bombs.includes(s-1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+(t-1))&&bombsNumber++):s===t*t-t?(bombs.includes(s+1)&&bombsNumber++,bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-(t-1))&&bombsNumber++):s===t*t-1?(bombs.includes(s-1)&&bombsNumber++,bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-(t+1))&&bombsNumber++):s%t==0?(bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-t+1)&&bombsNumber++,bombs.includes(s+1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+t+1)&&bombsNumber++):(s+1)%t==0?(bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-t-1)&&bombsNumber++,bombs.includes(s-1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+t-1)&&bombsNumber++):s-t<t?(bombs.includes(s-1)&&bombsNumber++,bombs.includes(s+1)&&bombsNumber++,bombs.includes(s+t+1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+t-1)&&bombsNumber++):t*t-t<s?(bombs.includes(s-1)&&bombsNumber++,bombs.includes(s+1)&&bombsNumber++,bombs.includes(s-t+1)&&bombsNumber++,bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-t-1)&&bombsNumber++):(bombs.includes(s-1)&&bombsNumber++,bombs.includes(s+1)&&bombsNumber++,bombs.includes(s-t+1)&&bombsNumber++,bombs.includes(s-t)&&bombsNumber++,bombs.includes(s-t-1)&&bombsNumber++,bombs.includes(s+t+1)&&bombsNumber++,bombs.includes(s+t)&&bombsNumber++,bombs.includes(s+t-1)&&bombsNumber++),e.target.innerHTML=bombsNumber,bombsNumber=0},showEmpty=function(e){e.target.classList.add("show-empty"),checkBombAround(e,chosenLevel[0])},leftClick=function(e){e.target.classList.contains("put-flag")?e.preventDefault():!1===boxes[e.target.id].bomb?showEmpty(e):!0===boxes[e.target.id].bomb&&(e.target.classList.add("show-trigger"),showAll())};navBar.addEventListener("click",unfoldMenu),navItems.forEach(function(e){return e.addEventListener("click",chooseLevel)}),gamePlate.addEventListener("contextmenu",putFlag),gamePlate.addEventListener("click",leftClick),newGame();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ2FtZVBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibmF2QmFyIiwiZ2FtZUxpc3QiLCJuYXZJdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb3VudGVyTWluZXMiLCJiZWdnaW5lciIsImludGVybWVkaWF0ZSIsImV4cGVydCIsImJvbWJzIiwiYm94ZXMiLCJjaG9zZW5MZXZlbCIsImJveGVzQW1vdW50IiwiaSIsImJvbWJzQW1vdW50IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiaW5jbHVkZXMiLCJyYW5kb21OdW0iLCJHYW1lUGxhdGUiLCJpZCIsImJvbWIiLCJzaHVmZmxlIiwidGhpcyIsImNyZWF0ZUdhbWVQbGF0ZSIsInB1c2giLCJmb3JFYWNoIiwiYm94IiwiZHJhd0dhbWVQbGF0ZSIsImVtcHR5Qm94IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZCIsInBsYW50Qm9tYnMiLCJhZGQiLCJjb25jYXQiLCJjbGVhclBsYXRlIiwiaW5uZXJIVE1MIiwiY291bnRCb3hlcyIsImUiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW92ZSIsIm5ld0dhbWUiLCJ0b2dnbGUiLCJpdGVtIiwicHJldmVudERlZmF1bHQiLCJzaG93QWxsIiwicGxhdGVFbGVtZW50cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJfaXRlcmF0b3IiLCJzIiwiX3N0ZXAiLCJuIiwiZG9uZSIsInZhbHVlIiwidW5mb2xkTWVudSIsImJvbWJzTnVtYmVyIiwiTnVtYmVyIiwicGFyc2VGbG9hdCIsInJvd0xlbmd0aCIsImNoZWNrQm9tYkFyb3VuZCIsInNob3dFbXB0eSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaG9vc2VMZXZlbCIsInB1dEZsYWciXSwibWFwcGluZ3MiOiI2akRBQUEsSUFBTUEsVUFBWUMsU0FBU0MsY0FBYyxrQkFBdkIsRUFDWkMsT0FBU0YsU0FBU0MsY0FBYyxTQUF2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WEgsR0FnREFBLFdBL0NBLEdBRURsRCxNQUFBUyxTQUFBRyxFQUFBeUMsRUFBQSxDQUFBLEdBZ0RDSCxXQS9DU3pDLEdBRVRULE1BQUFTLFNBQUFHLEVBQUF5QyxFQUFBLENBQUEsR0FnREFILFdBQVcsR0E5Q1hBLE1BQUFBLFNBQVd0QyxFQUFBeUMsQ0FBWEgsR0FpREFBLFdBaERBLEdBQ0RsRCxNQUFJQSxTQUFNUyxFQUFXNEMsRUFBRixDQUFuQixHQWtEQ0gsV0FqREFBLElBcURGbkIsRUFBRUMsT0FsREFrQixVQUFXQSxZQW1EYkEsWUFsREUsQ0FtREYsRUFqREVBLFVBQVcsU0FBQW5CLEdBb0RiQSxFQUFFQyxPQW5EQUMsVUFBQVAsSUFBQSxZQW1ERixFQUNBNEIsZ0JBbkRhdkIsRUFBR3NCLFlBQVlBLEVBQWYsQ0FvRGIsRUFqREVILFVBQVcsU0FBQW5CLEdBQ1hBLEVBQUFDLE9BQUFDLFVBQUFDLFNBQUEsVUFBQSxFQW9EREgsRUFBRVEsZUFBRixFQW5ENEIsQ0FBQSxJQUF4QnZDLE1BQU1TLEVBQUFBLE9BQVdHLElBQXJCQyxLQXFEQTBDLFVBcERDTCxDQUFBQSxFQUNBLENBQUEsSUFBQWpELE1BQUE4QixFQUFBQyxPQUFBcEIsSUFBQUMsT0FxRERrQixFQUFFQyxPQUFPQyxVQUFVUCxJQUFJLGNBQXZCLEVBQ0FjLFFBckRJeEMsRUF1REwsRUFHRFIsT0F0REcwRCxpQkFBVyxRQUFBRCxVQXNEZCxFQUNBdkQsU0F0REd3QixRQUFBLFNBQUFvQixHQUFBLE9BQUFBLEVBQUFrQixpQkFBQSxRQUFBQyxXQUFBLENBQUEsQ0FzREgsRUFDQXBFLFVBQVVtRSxpQkFBaUIsY0FBZUUsT0FBMUMsRUFDQXJFLFVBdkRNVyxpQkFBaUIsUUFBR3FELFNBdUQxQixFQUVBakIsUUF2REciLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lUGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZS1ib3hfX3BsYXRlJyk7XHJcbmNvbnN0IG5hdkJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZiYXInKTtcclxuY29uc3QgZ2FtZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2YmFyX19saXN0LWdhbWUnKTtcclxuY29uc3QgbmF2SXRlbXMgPSBnYW1lTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2YmFyX19saXN0X19pdGVtJyk7XHJcbmNvbnN0IGNvdW50ZXJNaW5lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb3VudGVyLW1pbmVzJyk7XHJcblxyXG5jb25zdCBiZWdnaW5lciA9IFs4LCA4LCAxMF07XHJcbmNvbnN0IGludGVybWVkaWF0ZSA9IFsxNiwgMTYsIDQwXTtcclxuY29uc3QgZXhwZXJ0ID0gWzMxLCAxNiwgOTldO1xyXG5cclxubGV0IGJvbWJzID0gW107XHJcbmxldCBib3hlcyA9IFtdO1xyXG5sZXQgY2hvc2VuTGV2ZWwgPSBiZWdnaW5lcjtcclxuXHJcbmNvbnN0IGNvdW50Qm94ZXMgPSBjaG9zZW5MZXZlbCA9PiB7XHJcblx0cmV0dXJuIGNob3NlbkxldmVsWzBdICogY2hvc2VuTGV2ZWxbMV07XHJcbn07XHJcblxyXG5jb25zdCBzaHVmZmxlID0gKGJveGVzQW1vdW50LCBib21ic0Ftb3VudCkgPT4ge1xyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYm9tYnNBbW91bnQ7IGkrKykge1xyXG5cdFx0bGV0IHJhbmRvbU51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJveGVzQW1vdW50KTtcclxuXHRcdGlmIChyYW5kb21OdW0gPT09IDAgfHwgYm9tYnMuaW5jbHVkZXMocmFuZG9tTnVtKSkge1xyXG5cdFx0XHRpLS07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRib21icy5wdXNoKHJhbmRvbU51bSk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuY2xhc3MgR2FtZVBsYXRlIHtcclxuXHRjb25zdHJ1Y3RvcihpZCwgYm9tYikge1xyXG5cdFx0dGhpcy5pZCA9IGlkO1xyXG5cdFx0dGhpcy5ib21iID0gYm9tYjtcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNyZWF0ZUdhbWVQbGF0ZSA9IGJveGVzQW1vdW50ID0+IHtcclxuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJveGVzQW1vdW50OyBpKyspIHtcclxuXHRcdGJveGVzW2ldID0gbmV3IEdhbWVQbGF0ZShpLCBmYWxzZSk7XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgcGxhbnRCb21icyA9ICgpID0+IHtcclxuXHRib3hlcy5mb3JFYWNoKGJveCA9PiB7XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoYm94LmlkKSkge1xyXG5cdFx0XHRib3guYm9tYiA9IHRydWU7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG5jb25zdCBkcmF3R2FtZVBsYXRlID0gYm94ZXNBbW91bnQgPT4ge1xyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYm94ZXNBbW91bnQ7IGkrKykge1xyXG5cdFx0bGV0IGVtcHR5Qm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRlbXB0eUJveC5zZXRBdHRyaWJ1dGUoJ2lkJywgaSk7XHJcblx0XHRnYW1lUGxhdGUuYXBwZW5kKGVtcHR5Qm94KTtcclxuXHRcdGVtcHR5Qm94LmNsYXNzTGlzdC5hZGQoJ2dhbWUtYm94X19wbGF0ZV9fZWxlbWVudCcpO1xyXG5cdH1cclxuXHRjb3VudGVyTWluZXMuaW5uZXJIVE1MID0gYDAke2Nob3NlbkxldmVsWzJdfWA7XHJcblx0Ly8gdHUgbW96ZSBmb3JFYWNoZW1wdHlCb3hcclxufTtcclxuXHJcbmNvbnN0IGNsZWFyUGxhdGUgPSAoKSA9PiB7XHJcblx0Z2FtZVBsYXRlLmlubmVySFRNTCA9ICcnO1xyXG5cdGJvbWJzID0gW107XHJcblx0Ym94ZXMgPSBbXTtcclxufTtcclxuXHJcbmNvbnN0IG5ld0dhbWUgPSAoKSA9PiB7XHJcblx0Y2xlYXJQbGF0ZSgpO1xyXG5cdGNvdW50ZXJNaW5lcy5pbm5lckhUTUwgPSBgMCR7Y2hvc2VuTGV2ZWxbMl19YDtcclxuXHRzaHVmZmxlKGNvdW50Qm94ZXMoY2hvc2VuTGV2ZWwpLCBjaG9zZW5MZXZlbFsyXSk7XHJcblx0Y3JlYXRlR2FtZVBsYXRlKGNvdW50Qm94ZXMoY2hvc2VuTGV2ZWwpKTtcclxuXHRwbGFudEJvbWJzKCk7XHJcblx0ZHJhd0dhbWVQbGF0ZShjb3VudEJveGVzKGNob3NlbkxldmVsKSk7XHJcbn07XHJcblxyXG5jb25zdCBjaG9vc2VMZXZlbCA9IGUgPT4ge1xyXG5cdGNsZWFyUGxhdGUoKTtcclxuXHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdiZWdnaW5lcicpKSB7XHJcblx0XHRjaG9zZW5MZXZlbCA9IGJlZ2dpbmVyO1xyXG5cdFx0Z2FtZVBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXRlLWludGVybWVkaWF0ZScpO1xyXG5cdFx0Z2FtZVBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXRlLWV4cGVydCcpO1xyXG5cdFx0Z2FtZVBsYXRlLmNsYXNzTGlzdC5hZGQoJ3BsYXRlLWJlZ2dpbmVyJyk7XHJcblx0fSBlbHNlIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ludGVybWVkaWF0ZScpKSB7XHJcblx0XHRjaG9zZW5MZXZlbCA9IGludGVybWVkaWF0ZTtcclxuXHRcdGdhbWVQbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdwbGF0ZS1iZWdnaW5lcicpO1xyXG5cdFx0Z2FtZVBsYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXRlLWV4cGVydCcpO1xyXG5cdFx0Z2FtZVBsYXRlLmNsYXNzTGlzdC5hZGQoJ3BsYXRlLWludGVybWVkaWF0ZScpO1xyXG5cdH0gZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdleHBlcnQnKSkge1xyXG5cdFx0Y2hvc2VuTGV2ZWwgPSBleHBlcnQ7XHJcblx0XHRnYW1lUGxhdGUuY2xhc3NMaXN0LnJlbW92ZSgncGxhdGUtYmVnZ2luZXInKTtcclxuXHRcdGdhbWVQbGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdwbGF0ZS1pbnRlcm1lZGlhdGUnKTtcclxuXHRcdGdhbWVQbGF0ZS5jbGFzc0xpc3QuYWRkKCdwbGF0ZS1leHBlcnQnKTtcclxuXHR9XHJcblx0bmF2SXRlbXMuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnbmF2YmFyX19saXN0LWdhbWVfX2l0ZW0nKSk7XHJcblxyXG5cdG5ld0dhbWUoKTtcclxufTtcclxuXHJcbmNvbnN0IHVuZm9sZE1lbnUgPSBlID0+IHtcclxuXHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCduYXZiYXJfX2xpc3QtZ2FtZScpKSB7XHJcblx0XHRuYXZJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QudG9nZ2xlKCduYXZiYXJfX2xpc3QtZ2FtZV9faXRlbScpKTtcclxuXHR9XHJcbn07XHJcblxyXG5jb25zdCBwdXRGbGFnID0gZSA9PiB7XHJcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ3B1dC1mbGFnJyk7XHJcbn07XHJcblxyXG5jb25zdCBzaG93QWxsID0gKCkgPT4ge1xyXG5cdGNvbnN0IHBsYXRlRWxlbWVudHMgPSBnYW1lUGxhdGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZ2FtZS1ib3hfX3BsYXRlX19lbGVtZW50Jyk7XHJcblxyXG5cdGZvciAoY29uc3QgYm94IG9mIGJveGVzKSB7XHJcblx0XHRpZiAoYm94LmJvbWIgPT09IHRydWUpIHtcclxuXHRcdFx0aWYgKCFwbGF0ZUVsZW1lbnRzW2JveC5pZF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdwdXQtZmxhZycpKSB7XHJcblx0XHRcdFx0cGxhdGVFbGVtZW50c1tib3guaWRdLmNsYXNzTGlzdC5hZGQoJ3Nob3ctYm9tYicpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoYm94LmJvbWIgPT09IGZhbHNlKSB7XHJcblx0XHRcdGlmIChwbGF0ZUVsZW1lbnRzW2JveC5pZF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdwdXQtZmxhZycpKSB7XHJcblx0XHRcdFx0cGxhdGVFbGVtZW50c1tib3guaWRdLmNsYXNzTGlzdC5hZGQoJ3dyb25nLWJldCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxubGV0IGJvbWJzTnVtYmVyID0gMDtcclxuXHJcbmNvbnN0IGNoZWNrQm9tYkFyb3VuZCA9IChlLCByb3dMZW5ndGgpID0+IHtcclxuXHRsZXQgaWQgPSBOdW1iZXIucGFyc2VGbG9hdChlLnRhcmdldC5pZCk7XHJcblx0aWYgKGlkID09PSAwKSB7XHJcblx0XHQvLyB0b3AtbGVmdCBjb3JuZXIgY2hlY2tcclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyByb3dMZW5ndGgpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyAocm93TGVuZ3RoICsgMSkpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmIChpZCA9PT0gcm93TGVuZ3RoIC0gMSkge1xyXG5cdFx0Ly8gdG9wLXJpZ2h0IGNvcm5lciBjaGVja1xyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIHJvd0xlbmd0aCkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIChyb3dMZW5ndGggLSAxKSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKGlkID09PSByb3dMZW5ndGggKiByb3dMZW5ndGggLSByb3dMZW5ndGgpIHtcclxuXHRcdC8vIGJvdHRvbS1sZWZ0IGNvcm5lciBjaGVja1xyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIHJvd0xlbmd0aCkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIChyb3dMZW5ndGggLSAxKSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKGlkID09PSByb3dMZW5ndGggKiByb3dMZW5ndGggLSAxKSB7XHJcblx0XHQvLyBib3R0b20tcmlnaHQgY29ybmVyIGNoZWNrXHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgLSAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gKHJvd0xlbmd0aCArIDEpKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoaWQgJSByb3dMZW5ndGggPT09IDApIHtcclxuXHRcdC8vIHNpZGUgbGVmdCBjaGVja1xyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoICsgMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyByb3dMZW5ndGgpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyByb3dMZW5ndGggKyAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoKGlkICsgMSkgJSByb3dMZW5ndGggPT09IDApIHtcclxuXHRcdC8vIHNpZGUgcmlnaHQgY2hlY2tcclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIHJvd0xlbmd0aCkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIHJvd0xlbmd0aCAtIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgLSAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKGlkIC0gcm93TGVuZ3RoIDwgcm93TGVuZ3RoKSB7XHJcblx0XHQvLyBzaWRlIHRvcCBjaGVja1xyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyByb3dMZW5ndGggKyAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKGlkID4gcm93TGVuZ3RoICogcm93TGVuZ3RoIC0gcm93TGVuZ3RoKSB7XHJcblx0XHQvLyBzaWRlIGJvdHRvbSBjaGVja1xyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCArIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgLSByb3dMZW5ndGggKyAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gdGhlIHJlc3Qgb2YgYm94ZXNcclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkIC0gcm93TGVuZ3RoICsgMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIHJvd0xlbmd0aCkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHRcdGlmIChib21icy5pbmNsdWRlcyhpZCAtIHJvd0xlbmd0aCAtIDEpKSB7XHJcblx0XHRcdGJvbWJzTnVtYmVyKys7XHJcblx0XHR9XHJcblx0XHRpZiAoYm9tYnMuaW5jbHVkZXMoaWQgKyByb3dMZW5ndGggKyAxKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoKSkge1xyXG5cdFx0XHRib21ic051bWJlcisrO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvbWJzLmluY2x1ZGVzKGlkICsgcm93TGVuZ3RoIC0gMSkpIHtcclxuXHRcdFx0Ym9tYnNOdW1iZXIrKztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGUudGFyZ2V0LmlubmVySFRNTCA9IGJvbWJzTnVtYmVyO1xyXG5cdGJvbWJzTnVtYmVyID0gMDtcclxufTtcclxuXHJcbmNvbnN0IHNob3dFbXB0eSA9IGUgPT4ge1xyXG5cdGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3Nob3ctZW1wdHknKTtcclxuXHRjaGVja0JvbWJBcm91bmQoZSwgY2hvc2VuTGV2ZWxbMF0pO1xyXG59O1xyXG5cclxuY29uc3QgbGVmdENsaWNrID0gZSA9PiB7XHJcblx0aWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncHV0LWZsYWcnKSkge1xyXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdH0gZWxzZSBpZiAoYm94ZXNbZS50YXJnZXQuaWRdLmJvbWIgPT09IGZhbHNlKSB7XHJcblx0XHRzaG93RW1wdHkoZSk7XHJcblx0fSBlbHNlIGlmIChib3hlc1tlLnRhcmdldC5pZF0uYm9tYiA9PT0gdHJ1ZSkge1xyXG5cdFx0ZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnc2hvdy10cmlnZ2VyJyk7XHJcblx0XHRzaG93QWxsKCk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gIExpc3RlbmVyc1xyXG5uYXZCYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB1bmZvbGRNZW51KTtcclxubmF2SXRlbXMuZm9yRWFjaChpdGVtID0+IGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaG9vc2VMZXZlbCkpO1xyXG5nYW1lUGxhdGUuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBwdXRGbGFnKTtcclxuZ2FtZVBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGVmdENsaWNrKTtcclxuXHJcbm5ld0dhbWUoKTtcclxuIl19
